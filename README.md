# jdi
Just do it! Сервер очереди заданий.

## Требования

* PHP 7.0+
* PDO (sqlite или mysql)
* cron, systemd

## Установка

Скопируйте репозиторий в папку на сервере, затем выполните:

```
# ./jdi.php db setup sqlite
# ./jdi.php db reinstall
```

Если необходмио, чтобы сервер был доступен определённому пользователю в системе, например www-data, то его
нужно указать в `configs/20-local.php`:

```php
<?php

Config()->setup([
    'owner' => [
        'user' => 'www-data',
        'group' => 'www-data',
    ],
]);
```

Не забудьте поменять владельца папки sys:

```
# chown -R www-data:www-data /path/to/jdi/sys
```

## Использование

Для добавления задания выполните:

```
# ./jdi.php add ls -lah /
```

Для просмотра списка заданий:

```
# ./jdi.php list
```

Для выполнения задания:

```
# ./jdi.php next
```

Задания выполняются в порядке их добавления и не более пяти одновременно.

## Установка демона

Для выполнений заданий сразу после добавления в очередь нужно установить сестемный сервис.
Сделать это можно так:

```
# ./jdi.php service install | sh
```

Для проверки статуса сервиса:

```
# service jdi status
```

Для удаления сервиса, выполните:

```
# ./jdi.php service remove | sh
```

## Дополнительно

Для справки используйте команду help:

```
# ./jdi.php help
Использование

./jdi.php [ПАРАМЕТРЫ] [КОМАНДА] [ПАРАМЕТРЫ КОМАНДЫ]

КОМАНДЫ
       add  Добавляет команду в очередь выполнения.
     clean  Чистит очередь заданий от устаревших записей.
        db  Работа с базой данных.
      help  Выводит текущую справку.
      list  Выводит список команд в очереди.
      next  Выполняет следующую команду в очереди.
   service  Позволяет устанавливать приложение как системую службу.
      task  Управление заданием.

Используйте `jdi.php help КОМАНДА' для получения справки по конкретной команде.
```